
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- Tell the browser to be responsive to screen width -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="description" content="">
    <meta name="author" content="Kerehore">
    <meta name="csrf-token" content="2gTlkkGVJGVHu4VITwTtXBBBoTmvTlSCF3P6RoUv">

    <!-- Favicon icon -->
    <link rel="icon" type="image/png" sizes="16x16" href="/UIPPOB/themes/assets/images/favicon.png" />
    <title>SPPOB</title>

    <!-- CSS -->
    <link href="/UIPPOB/themes/assets/plugins/jqueryui/jquery-ui.min.css" rel="stylesheet" />
    <link href="/UIPPOB/themes/assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="/UIPPOB/themes/assets/plugins/bootstrap-switch/bootstrap-switch.min.css" rel="stylesheet">
    <link href="/UIPPOB/themes/assets/plugins/bootstrap-select/bootstrap-select.min.css" rel="stylesheet" />
    <link href="/UIPPOB/themes/assets/plugins/bootstrap-datepicker/bootstrap-datepicker.min.css" rel="stylesheet" />
    <link href="/UIPPOB/themes/assets/plugins/bootstrap-table/dist/bootstrap-table.min.css" rel="stylesheet" />
    <link href="/UIPPOB/themes/assets/plugins/datatables/media/css/dataTables.bootstrap.min.css" rel="stylesheet" />
    <link href="/UIPPOB/themes/assets/plugins/toast-master/css/jquery.toast.css" rel="stylesheet">
    <link href="/UIPPOB/themes/assets/plugins/dropify/dist/css/dropify.min.css" rel="stylesheet">
    <link href="/UIPPOB/themes/assets/plugins/sweetalert/sweetalert.css" rel="stylesheet" />
    <link href="/UIPPOB/themes/css/style.css" rel="stylesheet" />
    <link href="https://cdn.datatables.net/select/1.2.5/css/select.dataTables.min.css" rel="stylesheet" />

    <!-- Custom CSS -->
    <link href="/UIPPOB/themes/css/chosen.css" rel="stylesheet" />
    <link href="/UIPPOB/themes/css/mahta.css" rel="stylesheet" />

    <!-- You can change the theme colors from here -->
    <link href="/UIPPOB/themes/css/colors/blue.css" id="theme" rel="stylesheet" />

    <script src="/UIPPOB/themes/assets/plugins/jquery/jquery.min.js"></script>
    <script src="/UIPPOB/themes/assets/plugins/jquery/jquery.mask.min.js"></script>
    <script src="/UIPPOB/themes/assets/plugins/jqueryui/jquery-ui.min.js"></script>
    <script src="/UIPPOB/themes/assets/plugins/bootstrap/js/popper.min.js"></script>
    <script src="/UIPPOB/themes/assets/plugins/bootstrap/js/bootstrap.min.js"></script>
    <script src="/UIPPOB/themes/assets/plugins/bootstrap-datepicker/bootstrap-datepicker.min.js"></script>
    <script src="/UIPPOB/themes/assets/plugins/bootstrap-select/bootstrap-select.min.js"></script>
    <script src="/UIPPOB/themes/assets/plugins/bootstrap-table/dist/bootstrap-table.min.js"></script>
    <script src="/UIPPOB/themes/assets/plugins/sticky-kit-master/dist/sticky-kit.min.js"></script>
    <script src="/UIPPOB/themes/assets/plugins/bootstrap-switch/bootstrap-switch.min.js"></script>
    <script src="/UIPPOB/themes/assets/plugins/styleswitcher/jQuery.style.switcher.js"></script>
    <script src="/UIPPOB/themes/assets/plugins/sweetalert/sweetalert.min.js"></script>
    <script src="/UIPPOB/themes/assets/plugins/datatables/jquery.dataTables.min.js"></script>
    <script src="/UIPPOB/themes/assets/plugins/toast-master/js/jquery.toast.js"></script>
    <script src="/UIPPOB/themes/assets/plugins/numeral-js/min/numeral.min.js"></script>
    <script src="/UIPPOB/themes/js/jquery.slimscroll.js"></script>
    <script src="/UIPPOB/themes/js/sidebarmenu.js"></script>
    <script src="/UIPPOB/themes/js/custom.min.js"></script>
    <script src="/UIPPOB/themes/js/waves.js"></script>
    <script src="/UIPPOB/themes/js/chosen.jquery.js"></script>
    <script src="/js/multiple_input.js" type="text/javascript"/></script>

</head>

<body class="fix-header fix-sidebar logo-center">
    <!-- ============================================================== -->
    <!-- Preloader - style you can find in spinners.css -->
    <!-- ============================================================== -->
    <div class="preloader">
        <svg class="circular" viewBox="25 25 50 50">
            <circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10" /> </svg>
    </div>
    <div id="main-wrapper">
        <header class="topbar">
            <nav class="navbar top-navbar navbar-expand-md navbar-light">
                <div class="navbar-header">
                    <a class="navbar-brand" href="/">
                        <span style="color: #ffffff;">
                             Manage Product
                        </span> </a>
                </div>
                <div class="navbar-collapse">
                    <ul class="navbar-nav mr-auto mt-md-0">
                        <li class="nav-item"> <a class="nav-link nav-toggler hidden-md-up text-muted waves-effect waves-dark" href="javascript:void(0)"><i class="mdi mdi-menu"></i></a> </li>
                    </ul>
                    <ul class="navbar-nav my-lg-0">
						<li class="nav-item" style="border-right: 1px solid #afafaf;border-left: 1px solid #afafaf;"> 
							<a class="nav-link dropdown-toggle text-muted waves-effect waves-dark" href="/UIPPOB/adminpanel/deposit" >Balance: Rp. 100.000.000 </a>
						</li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle text-muted waves-effect waves-dark" href="" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Mastersss <span></span></a>
                            <div class="dropdown-menu dropdown-menu-right scale-up">
                                <ul class="dropdown-user">
                                    <li style="padding: 12px;font-size:12px;"> 
										<div style="border-bottom: 2px solid #cacaca;font-weight: bold;padding-bottom: 6px;">Detail Deposit</div>
										<div class="row p-t-10">
											<div class="col-md-4">Mitracomm</div>
											<div class="col-md-8">: Rp 40.000.000</div>
										</div>
										<div class="row">
											<div class="col-md-4">Prismalink</div>
											<div class="col-md-8">: Rp 30.000.000</div>
										</div>
										<div class="row">
											<div class="col-md-4">Bima Sakti</div>
											<div class="col-md-8">: Rp 30.000.000</div>
										</div>
                                    </li>
                                    <li style="font-size:12px;text-align:right">
                                        <a href="/UIPPOB/logout"
                                           onclick="event.preventDefault();
                                                         document.getElementById('logout-form').submit();">
                                            <i class="fa fa-power-off"></i> Logout
                                        </a>

                                        <form id="logout-form" action="/UIPPOB/logout" method="POST" style="display: none;">
                                            <input type="hidden" name="_token" value="2gTlkkGVJGVHu4VITwTtXBBBoTmvTlSCF3P6RoUv">                                        </form>
                                    </li>
                                </ul>
                            </div>
                        </li>
                    </ul>
                </div>
            </nav>
        </header>
               <div class="wrapper">
            <!-- Sidebar  -->
            <nav id="sidebar">
                <div class="sidebar-header">
                    <h2>
                        <a href="http://192.168.1.130:8085" style="color: #fff;">
                            PPOB
                        </a>
                    </h2>
                </div>

                <ul class="list-unstyled components"><li ><a href="http://192.168.1.130:8085">Dashboard</a></li><li ><a href="#homeSubmenu2" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Users</a><ul class="collapse list-unstyled" id="homeSubmenu2"><li ><a href="/UIPPOB/adminpanel/manusers">Manage Users</a></li><li ><a href="/UIPPOB/adminpanel/groupuser">User Groups</a></li><li ><a href="/UIPPOB/adminpanel/roleusers">Role Users</a></li></ul></li><li ><a href="#homeSubmenu3" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Products</a><ul class="collapse list-unstyled" id="homeSubmenu3"><li class="active"><a href="/UIPPOB/adminpanel/product">Manage Products</a></li><li ><a href="/UIPPOB/adminpanel/prodtype">Product Types</a></li><li ><a href="/UIPPOB/adminpanel/prodcat">Product Categories</a></li></ul></li><li ><a href="/UIPPOB/adminpanel/client">Clients</a></li><li ><a href="/UIPPOB/adminpanel/prodpartner">Manage Partners</a></li><li ><a href="/UIPPOB/adminpanel/switching">Manage Switching</a></li><li ><a href="/UIPPOB/adminpanel/reporting">Reporting</a></li><li ><a href="/UIPPOB/adminpanel/deposit">Deposit</a></li><li ><a href="/UIPPOB/adminpanel/adaptor">Adaptor</a></li></ul>

                
            </nav>

            <!-- Page Content  -->
            <div id="content">
                <div class="row page-titles col-md-5 " style="background: #fff0;">
                    <div class=" align-self-center">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="http://192.168.1.130:8085">Home</a></li>
                            <li class="breadcrumb-item"> Manage Product</li>
                                                    </ol>
                    </div>
                </div>
                <div class="container-fluid">
                    <div class="panel panel-default">
    <div class="panel-body">
		<div class="row col-md-12 p-l-0 m-b-10">
            <label for="name" class="col-md-2 control-label panel-status">Partner</label>
            <div class="col-md-3">
              <select class="form-control comCor fz13" name="partner" id="partner">
                <option value="" selected>All</option>
              </select>
            </div>
            <label for="name" class="col-md-1 control-label panel-status">Category</label>
            <div class="col-md-3">
              <select class="form-control comCor fz13" name="changecategory" id="changecategory">
                <option value="" selected>All</option>
              </select>
            </div>
        </div>
		<div class="form-group row col-md-12 p-l-0">
            <label for="name" class="col-md-2 control-label panel-status">Product Type</label>
            <div class="col-md-3">
              <select class="form-control comCor fz13" name="product_type" id="product_type">
                <option value="" selected>All</option>
              </select>
            </div>
            <label for="name" class="col-md-1 control-label panel-status">Status</label>
            <div class="col-md-2">
              <select class="form-control comCor fz13" name="changestatus" id="changestatus">
                <option value="" selected>All</option>
                <option value="active">Active</option>
                <option value="inactive">Inactive</option>
              </select>
            </div>
            <br>
            <br>
          </div>
        <a id="btnNew" class="btn btn-info fz13 btn-sm" href="/UIPPOB/adminpanel/product/create">New</a>
        <a id="btnDelete" class="btn btn-info fz13 btn-sm" href="javascript:void(0)">Delete</a>
        <table id="dataTable" width="100%" cellspacing="0" class="table table-bordered table-striped p15 fz13 va-mid p-td-imp">
            <thead>
                <tr class="bold">
                    <th>
                        <input type="checkbox" name="chkid" data-id="datainputAll" id="datainputAll" class="dataAllUser filled-in chk-col-light-blue">
                    </th>
                    <th>Partner</th>
                    <th>Category</th>
                    <th>Product Type</th>
                    <th>Product Name</th>
                    <th>Denom</th>
                    <th>Base Price</th>
                    <th>Publish Rate</th>
                    <th>Admin Fee</th>
                    <th>CashBack</th>
                    <th>Status</th>
                    <th width="7%">Action</th>
                </tr>
            </thead>
            <tfoot>
                <tr class="bold">
                    <th></th>
                    <th>Partner</th>
                    <th>Category</th>
                    <th>Product Type</th>
                    <th>Product Name</th>
                    <th>Denom</th>
                    <th>Base Price</th>
                    <th>Publish Rate</th>
                    <th>Admin Fee</th>
                    <th>CashBack</th>
                    <th>Status</th>
                    <th width="7%">Action</th>
                </tr>
            </tfoot>
        </table>
    </div>
  </div>
<script>
  $(document).ready( function () {
		getProductType();
		getAllPartners();
		getProductCategories();
		
      $('#dataTable').DataTable({
        processing: true,
        serverSide: true,
        ajax: {
            "url": '/UIPPOB/adminpanel/getproduct',
            "type": "POST",
            headers: {
            'X-CSRF-TOKEN': "2gTlkkGVJGVHu4VITwTtXBBBoTmvTlSCF3P6RoUv"
            }
        },
        columns: [
            { data: 'chkid', name: 'chkid' },
            { data: 'partner_name', name: 'partner_name' },
            { data: 'product_category_name', name: 'product_category_name' },
            { data: 'product_type_name', name: 'product_type_name' },
            { data: 'name', name: 'name' },
            { data: 'denom', name: 'denom' },
            { data: 'basePrice', name: 'basePrice' },
            { data: 'retailPrice', name: 'retailPrice' },
            { data: 'adminFee', name: 'adminFee' },
            { data: 'cashback', name: 'cashback' },
            { data: 'status', name: 'status' },
            { data: 'action', name: 'action' }
        ],
        columnDefs: [
          { "targets": [0, 9], "searchable": false, "orderable": false, "visible": true }
        ]

      });
	  
	  $('#partner, #changecategory, #product_type, #changestatus').change(function() {
            var partner = $("#partner").val();
            var category = $("#changecategory").val();
            var product_type = $("#product_type").val();
            var changestatus = $("#changestatus").val();
            var data = { partner: partner, id_category: category, id:product_type, status: changestatus };
            $('#dataTable').DataTable().destroy();
            $('#dataTable').DataTable({

              processing: true,
              serverSide: true,
              ajax: {
                  url: '/UIPPOB/adminpanel/getproduct',
                  type: "POST",
                  headers: {
                  'X-CSRF-TOKEN': "2gTlkkGVJGVHu4VITwTtXBBBoTmvTlSCF3P6RoUv"
                  },
                  data: data
              },
              columns: [
					{ data: 'chkid', name: 'chkid' },
					{ data: 'partner_name', name: 'partner_name' },
					{ data: 'product_category_name', name: 'product_category_name' },
					{ data: 'product_type_name', name: 'product_type_name' },
					{ data: 'name', name: 'name' },
					{ data: 'denomination', name: 'denomination' },
					{ data: 'basePrice', name: 'basePrice' },
					{ data: 'retailPrice', name: 'retailPrice' },
					{ data: 'adminFee', name: 'adminFee' },
					{ data: 'cashback', name: 'cashback' },
					{ data: 'status', name: 'status' },
					{ data: 'action', name: 'action' }
              ],
              columnDefs: [
                { "targets": [0, 6], "searchable": false, "orderable": false, "visible": true }
              ]

            });
        });

  $('#btnDelete').on('click', function (e) {
    var check = $(".cbUser:checked");
    var id = check.attr("id");
    var c = check.length;

    if (c > 0) {
        swal({
            title: "Are you sure to delete this data?",
            type: "warning",
            showCancelButton: true,
            confirmButtonColor: "#DD6B55",
            confirmButtonText: "Yes, Delete Data!",
            closeOnConfirm: false
        }, function () {
           var arrId = [];
            $.each(check, function(index, rowId){
               deleteCorporate(rowId.id, c);
            }).promise().done( function(){ 
              swal({
              title: "Done!",
              text: "Data has been deleted.",
              type: "success",
                 },function() {   
                  setTimeout(function () {        
                    window.location = "/UIPPOB/adminpanel/roleusers";
                  },50);
                });
            });
        });
    } else {
        swal("Warning!", "Data that you want to delete has not been selected!", "warning")
    }

    function deleteCorporate(id) {
      setTimeout(function () {  
        $.ajax({
          url:'deleteproduct/'+id,
          type: "GET",
          dataType: 'json',          
          success: function (data) {
            console.log(data);
          }
        });
      }, 500);
    }
  });


      $(document).on("click", ".dataAllUser", function () {
        if (!$(".dataAllUser").is(":checked")) {
          console.log('masuk');
          $(".cbUser").prop("checked", false);
        } else {
          console.log('masuk2');
          $(".cbUser").prop("checked", true);
        }
      });
  });
  
    function getProductCategories() {
    $.ajax({
        crossDomain: true,
        crossOrigin: true,
        cache: false,
        type: "GET",
        url: '/UIPPOB/adminpanel/allprodcat',
        success: function(data) {

          for (var i = 0; i < data.length; i++) {
              var result = data[i];
              $('#changecategory').append('<option value="' + result.id + '">' + result.name + '</option>');
          }
          $('#changecategory').chosen();

        }
    });
  }

  function getProductType() {
    $.ajax({
        crossDomain: true,
        crossOrigin: true,
        cache: false,
        type: "GET",
        url: '/UIPPOB/adminpanel/allprodtype',
        success: function(data) {

          for (var i = 0; i < data.length; i++) {
              var result = data[i];
              $('#product_type').append('<option value="' + result.id + '">' + result.name + '</option>');
          }
          $('#product_type').chosen();

        }
    });
  }
  
  function getAllPartners() {
    $.ajax({
        crossDomain: true,
        crossOrigin: true,
        cache: false,
        type: "GET",
        url: '/UIPPOB/adminpanel/allpartners',
        success: function(data) {

          for (var i = 0; i < data.length; i++) {
              var result = data[i];
              $('#partner').append('<option value="' + result.id + '">' + result.name + '</option>');
          }
          $('#partner').chosen();

        }
    });
  }

</script>
                </div>
                <footer class="footer"> © 2020 Copyright by PT Sprint Asia Technology</footer>
            </div>
        </div>

            </div>
    
        <script type="text/javascript">
            $(document).ready(function () {

                $('#sidebarCollapse').on('click', function () {
                    $('#sidebar, #content').toggleClass('active');
                    $('.collapse.in').toggleClass('in');
                    $('a[aria-expanded=true]').attr('aria-expanded', 'false');
                });
                $('#sidebar li.active').parents('li').children('a').trigger('click');
            });
        </script>
    </body>

</html>